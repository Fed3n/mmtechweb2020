<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/http-vue-loader"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script src="https://unpkg.com/vue-observe-visibility/dist/vue-observe-visibility.min.js"></script>
    <script src="qrcode.min.js"></script>
    <link href="external.css" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
    <!-- FONT -->
    <link href="https://fonts.googleapis.com/css2?family=Faster+One&display=swap" rel="stylesheet">  <!-- font-family: 'Faster One', cursive; -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">   <!-- font-family: 'Orbitron', sans-serif; -->
    <title>Ambiente Autore</title>
</head>

<body class="bg-light">
    <div id="app" class="container-fluid mb-4">
        <!--COLLASSABILE DI MENU SERVER/FILES-->
        <div class="jumbotron jumbotron-fluid bg-info text-light">
            <div class="container-fluid">
                <h1>Ambiente Autore</h1>
                <p>Crea e gestisci le tue storie di M&M!</p>
            </div>
            <div class="container-fluid border-top">
                <h2>Storia caricata: {{ loadedStory ? loadedStory : "Nessuna! Carica una storia"}}</h2>
                <p v-if="!loadedStory">Inizia a creare la tua storia e premi il tasto SAVE una volta completata. Apri AREA STORIE per gestire tutte le storie disponibili.</p>
            </div>
        </div>
        <button class="btn btn-block btn-info" type="button" data-toggle="collapse" data-target="#managedata">AREA STORIE</button>
        <div id="managedata" class="row container-fluid collapse p-3">
            <div id="server-manage" class="col-md-8 border-right">
                <h2 class="bg-info text-light">Il tuo archivio</h2>
                <div class="row">
                    <!--GET / DELETE IN FS-->
                    <label for="select-story">Storie Registrate</label>
                    <select name="select-story" class="custom-select" size="6" ref="selectedStory">
                        <option v-for="story in storyList" :value="story" data-toggle="tooltip" :title="activeStoryList.includes(story) ? 'Attiva' : 'Inattiva'"
                        :style="{ color: activeStoryList.includes(story) ? 'green' : 'red' }">{{ story }}</option>
                    </select>
                    <div class="btn btn-group">
                        <button class="btn btn-success" v-on:click="getStory">GET</button>
                        <button class="btn btn-danger" v-on:click="deleteStory">DELETE</button>
                    </div>
                </div>
                <!--IMMAGINI CARICATE-->
                <div id="uploadimages" class="row border-top mt-2">
                    <div class="col-md-4">
                        <div class="form-group mb-2">
                            <label for="img_upload">Carica immagini per la storia corrente: </label>
                            <input class="form-control-file" type="file" accept="image/*" name="img_upload" ref="img_upload">
                        </div>
                        <button class="btn btn-primary" v-on:click="uploadImg()">CARICA</button>
                    </div>
                    <div class="col-md-4">
                        <div class=" row form-group mb-2">
                            <label for="select-image">Immagini nella storia corrente: </label>
                            <select name="select-image" class="form-control" v-model="selectedImage">
                                <option v-for="imgname in imagesList" :value="imgname">{{ imgname }}</option>
                            </select>
                            <div>
                                <button class="btn btn-danger" v-on:click="deleteImg()">DELETE</button>
                            </div>
                            <div id="image-preview" v-if="selectedImage" class="container-fluid mt-2">
                                <img class="img-thumbnail" width="60%" :src="'story/' + metadata.name + '/images/' + selectedImage" :alt="'Preview of ' + selectedImage">
                            </div>
                        </div>
                    </div>
                </div>
                <!--VIDEO CARICATI-->
                <div id="uploadvideos" class="row border-top mt-2">
                    <div class="col-md-4">
                        <div class="form-group mb-2">
                            <label for="vid_upload">Carica video per la storia corrente: </label>
                            <input class="form-control-file" type="file" accept="video/*" name="vid_upload" ref="vid_upload">
                        </div>
                        <button class="btn btn-primary" v-on:click="uploadVid()">CARICA</button>
                    </div>
                    <div class="col-md-4">
                        <div class=" row form-group mb-2">
                            <label for="select-video">Video nella storia corrente: </label>
                            <select name="select-video" class="form-control" v-model="selectedVideo">
                                <option v-for="vidname in vidsList" :value="vidname">{{ vidname }}</option>
                            </select>
                            <div>
                                <button class="btn btn-danger" v-on:click="deleteVid()">DELETE</button>
                            </div>
                            <div id="video-preview" v-if="selectedVideo" class="container-fluid mt-2">
                                <video width="60%" controls :src="'story/' + metadata.name + '/videos/' + selectedVideo">Anteprima di {{ selectedVideo }}</video>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="saveload" class="col-md-4 border-left">
                <h2 class="bg-info text-light">Creazione QR Code e file .json della storia</h2>
                <div id="jsonLoader" class="container border-bottom pb-3 m-3">
                    <div class="form-group row">
                        <label for="file-loader" class="col-md-5" >caricamento storia da file</label>
                        <div class="col-7"><input name="file-loader" class="form-control-file" type="file" ref="toLoad"></div>
                    </div>
                    <button class="btn btn-success" v-on:click="loadJson">CARICA STORIA</button>
                </div>
                <div id="jsonSaver" class="container m-3">
                    <div class="form-group row">
                        <label class="col-md-5" for="file-downloader">Salva file della storia</label>
                        <div class="col-7"><input name="file-downloader" type="text" value="myfile.json" ref="fileName"></div>
                    </div>
                    <button class="btn btn-success" v-on:click="saveJson">SCARICA FILE</button>
                    <div id="qrcreate" class="mt-3">
                        <button class="btn btn-info" v-on:click="createQR">Crea QR Code</button>
                    </div>
                </div>
            </div>
        </div>
        <!--AREA PREVIEW E STORY SETTING-->
        <div class="container-fluid border">
            <div id="server-storyinfo" class="row container-fluid pt-2 pb-2 border-bottom">
                <div class="col form-group">
                    <label for="story-name">Nome della Storia</label>
                    <input name="story-name" class="form-control" type="text" v-model="metadata.name" ref="storyName">
                </div>
                <div class="col form-check">
                    <label for="activate" class="form-check-label"><input name="activate" class="form-check-input" type="checkbox" v-model="metadata.active">
                        Attiva
                    </label>
                </div>
                <div class="col form-check">
                    <label for="accessibility" class="form-check-label"><input name="accessibility" class="form-check-input" type="checkbox" v-model="metadata.accessible">
                        Accessibile
                    </label>
                </div>
                <div class="col form-group">
                    <label for="language">Lingua</label>
                    <input name="language" class="form-control" type="text" v-model="metadata.language">
                </div>
                <div class="btn-group">
                    <button class="col btn btn-info" v-on:click="postStory" data-toggle="tooltip" title="salva la tua storia">SAVE</button>
                    <button class="col btn btn-secondary" v-on:click="resetData" data-toggle="tooltip" title="resetta i campi ed inizia una nuova storia">RESET</button>
                </div>
            </div>
        </div>
        <div id="editor" class="row container-fluid mt-2">
            <!--QUICK ACCESS/CREATION/REMOVAL-->
            <div class="col-md-2 container pt-3 pb-3 border-right">
                <!--Passaggio da schermata main a sub e viceversa-->
                <div class="btn-group container-fluid pb-3">
                    <button class="btn btn-light" v-on:click="switchMainSub" :disabled="previewdata.in_mainquest">Main</button>
                    <button class="btn btn-light" v-on:click="switchMainSub" :disabled="!previewdata.in_mainquest">Sub</button>
                </div>
                <!--Aggiunta nuovo nodo main/sub-->
                <div class="container pd-1">
                    <button class="btn btn-primary" v-on:click="addNode">Nuovo</button>
                </div>
                <div class="btn-group pt-1 pb-1">
                    <button class="btn btn-secondary" v-on:click="copyStory">Copia</button>
                    <button class="btn btn-secondary" v-on:click="pasteStory">Incolla</button>
                </div>
                <!--Accesso rapido alle quest usando v-for buttons-->
                <!--TODO Chiuderlo in un box con overflow a scorrimento maybe?-->
                <div>
                    <label for="questlistcontainer">Accesso diretto:</label>
                    <div name="questlistcontainer" class="container border-top p-2 mx-25 overflow-auto">
                        <div v-for="quest in questList" class="btn-group container-fluid pb-1">
                            <button class="btn btn-block bg-white border border-dark"
                            v-on:click="previewdata.in_mainquest ? jumpToQuest('main',quest.number) : jumpToQuest('sub',quest.number)">
                                {{ quest.title || quest.number }}
                            </button>
                            <button class="btn btn-danger" v-on:click="previewdata.in_mainquest ? rmMainNode(quest.number) : rmSubNode(quest.number)">Cancella</button>
                            <span class="col form-check ml-1" id="subquestadd" v-if="!previewdata.in_mainquest">
                                <input class="form-check-input" :name="'sub ' + quest.number" type="checkbox" :value="quest.number" v-model="previewdata.completedSubs">
                                <label class="form-check-label" :for="'sub ' + quest.number">Completata</label>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <!--PREVIEW E OBJECT EDITOR-->
            <div class="col-md-10">
                <!--MODIFICA STILI-->
                <button class="btn btn-block btn-info" type="button" data-toggle="collapse" data-target="#stylepanel">MODIFICA LO STILE</button>
                <!-- stili principali -->
      					<div id="stylepanel" class="row container-fluid collapse p-3 border-bottom">
      						<div class="row container-fluid">
        						<!-- IMMAGINE O SFONDO -->
      							<div id="backgroundStyle" class="col-md-6">
      									<div class="btn-group container-fluid mb-4">
      						        <button class="btn btn-light" v-on:click="gamedata.css_style.background.image = true" :disabled="gamedata.css_style.background.image">Immagine</button>
      						        <button class="btn btn-light" v-on:click="gamedata.css_style.background.image = false" :disabled="!gamedata.css_style.background.image">Colore</button>
                  			</div>
                        <div class="container-fluid">
                          <div id="setStyle" class="panel-group mb-3">
                            <!-- scegli l'immagine -->
                  					<div v-if="gamedata.css_style.background.image">
                              <div class="panel panel-default">
                                <div class="panel-heading py-2 border-bottom border-top">
                                  <div class="panel-title" data-toggle="collapse" data-parent="#setStyle" href="#imageEditor" @click="styleMenuCollapse">
                                    <label>Immagine di Sfondo</label>
                                  </div>
                                </div>
                                <div id="imageEditor" class="panel-collapse collapse stylepanelcollapse">
                                  <div class="panel-body border-bottom mt-2 px-4 pb-3">
                                    <label for="select-image">Scegli l'immagine: </label>
                                    <select ref="selectimages" name="select-image" class="form-control" v-model="gamedata.css_style.background.url">
                                        <option v-if="imagesList.length > 0" value="">nessuna immagine selezionata</option>
                                        <option v-for="imgname in imagesList" :value=`url('story/${metadata.name}/images/${imgname}')`>{{ imgname }}</option>
                                    </select>
                                    <small v-if="!imagesList" class="text-muted">Non sono presenti immagini in questa storia, caricane una nella sezione "area dati"</small>
                                  </div>
                                </div>
                              </div>
                  					</div>
                            <div v-if="!gamedata.css_style.background.image">
                              <!-- NAVBAR -->
                              <div class="panel panel-default">
                                <div class="panel-heading py-2 border-bottom border-top">
                                  <div class="panel-title" data-toggle="collapse" data-parent="#setStyle" href="#navigationBarEditor" @click="styleMenuCollapse">
                                    <label>Barra di Navigazione</label>
                                  </div>
                                </div>
                                <div id="navigationBarEditor" class="panel-collapse collapse stylepanelcollapse">
                                  <div class="panel-body border-bottom mt-2">
                                    <!-- colori predefiniti -->
                                    <div v-if="!gamedata.css_style.background.style.nav.custom">
          														<div class="form-group row pl-4 my-0">
          															<label class="col col-form-label">Colore del Testo</label>
          															<div class="col">
          																<select class="form-control" name="navigationBarStyle" v-model="gamedata.css_style.background.style.nav.bootstrap.textColor">
          																	<option v-for="styles in bootstrapConsts.navTextColors" :value="styles.value">{{ styles.name }}</option>
          																</select>
          															</div>
          														</div>
          														<div class="form-group row pl-4 my-0">
          															<label class="col col-form-label">Colore di Sfondo</label>
          															<div class="col">
          																<select class="form-control" name="navigationBarStyle" v-model="gamedata.css_style.background.style.nav.bootstrap.background">
          																	<option v-for="styles in bootstrapConsts.navCardBackgroundColors" :value="styles.value">{{ styles.name }}</option>
          																</select>
          															</div>
          														</div>
                                    </div>
                                    <!-- colori a scelta -->
                                    <div v-if="gamedata.css_style.background.style.nav.custom">
                                      <div class="form-group row pl-3 my-0">
                                        <label for="textColorNavCustom" class="col-md-6">Colore del Testo</label>
                                        <div class="col-md-6">
                                          <input name="textColorNavCustom" type="color" v-model="gamedata.css_style.background.style.nav.customized.general['color']">
                                        </div>
                                      </div>
                                      <div class="form-group row pl-3 my-0">
                                        <label for="backgroundColorNavCustom" class="col-md-6">Colore di Sfondo</label>
                                        <div class="col-md-6">
                                          <input name="backgroundColorNavCustom" type="color" v-model="gamedata.css_style.background.style.nav.customized.general['background-color']">
                                        </div>
                                      </div>
                                    </div>
                                    <div class="container-fluid text-center mb-0 mt-2">
               												<label for="navcheckbox">Altri Colori</label>
               												<input id="navcheckbox" type="checkbox" v-model="gamedata.css_style.background.style.nav.custom">
               											</div>
                                  </div>
                                </div>
                              </div>
                              <!-- CARD -->
                              <div class="panel panel-default">
                                <div class="panel-heading py-2 border-bottom">
                                  <div class="panel-title" data-toggle="collapse" data-parent="#setStyle" href="#cardStyleEditor" @click="styleMenuCollapse">
                                    <label>Corpo Centrale</label>
                                  </div>
                                </div>
                                <div id="cardStyleEditor" class="panel-collapse collapse stylepanelcollapse">
                                  <div class="panel-body border-bottom mt-2">
                                    <!-- colori predefiniti -->
                                    <div v-if="!gamedata.css_style.background.style.card.custom">
                                      <div class="form-group row pl-4 my-0">
                                        <label class="col col-form-label">Colore del Testo</label>
                                        <div class="col">
                                          <select class="form-control" name="cardTextStyle" v-model="gamedata.css_style.background.style.card.bootstrap.textColor">
                                            <option v-for="styles in bootstrapConsts.cardTextColors" :value="styles.value">{{ styles.name }}</option>
                                          </select>
                                        </div>
                                      </div>
                                      <div class="form-group row pl-4 my-0">
                                        <label class="col col-form-label">Colore di Sfondo</label>
                                        <div class="col">
                                          <select class="form-control" name="cardBackgroundStyle" v-model="gamedata.css_style.background.style.card.bootstrap.background">
                                            <option v-for="styles in bootstrapConsts.navCardBackgroundColors" :value="styles.value">{{ styles.name }}</option>
                                          </select>
                                        </div>
                                      </div>
                                    </div>
                                    <!-- colori a scelta -->
                                    <div v-if="gamedata.css_style.background.style.card.custom">
                                      <div class="form-group row pl-3 my-0">
                                        <label for="textColorCardCustom" class="col-md-6">Colore del Testo</label>
                                        <div class="col-md-6">
                                          <input name="textColorCardCustom" type="color" v-model="gamedata.css_style.background.style.card.customized['color']">
                                        </div>
                                      </div>
                                      <div class="form-group row pl-3 my-0">
                                        <label for="backgroundColorCardCustom" class="col-md-6">Colore di Sfondo</label>
                                        <div class="col-md-6">
                                          <input name="backgroundColorCardCustom" type="color" v-model="gamedata.css_style.background.style.card.customized['background-color']">
                                        </div>
                                      </div>
                                    </div>
                                    <div class="container-fluid text-center mb-0 mt-2">
                                      <label for="cardcheckbox">Altri Colori</label>
                                      <input id="cardcheckbox" type="checkbox" v-model="gamedata.css_style.background.style.card.custom">
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <!-- BADGE -->
                            <div class="panel panel-default">
                              <div class="panel-heading py-2 border-bottom">
                                <div class="panel-title" data-toggle="collapse" rata-parent="#setStyle" href="#badgeStyleEditor" @click="styleMenuCollapse">
                                  <label>Etichetta obiettivi secondari(Sub) disponibili</label>
                                </div>
                              </div>
                              <div id="badgeStyleEditor" class="panel-collapse collapse stylepanelcollapse">
                                <div class="panel-body border-bottom mt-2">
                                  <!-- tipologia predefinita -->
                                  <div v-if="!gamedata.css_style.background.style.badge.custom">
                                    <div class="form-group row pl-4 my-0">
                                      <label class="col col-form-label">Tipologia</label>
                                      <div class="col">
                                        <select class="form-control" name="badgeBootstrapEditor" v-model="gamedata.css_style.background.style.badge.bootstrap.type">
                                          <option v-for="styles in bootstrapConsts.badgeColors" :value="styles.value">{{ styles.name }}</option>
                                        </select>
                                      </div>
                                    </div>
                                  </div>
                                  <!-- stile personalizzato -->
                                  <div v-if="gamedata.css_style.background.style.badge.custom">
                                    <div class="form-group row pl-3 my-0">
                                      <label for="textColorBadgeCustom" class="col-md-6">Colore del Testo</label>
                                      <div class="col-md-6">
                                        <input name="textColorBadgeCustom" type="color" v-model="gamedata.css_style.background.style.badge.customized['color']">
                                      </div>
                                    </div>
                                    <div class="form-group row pl-3 my-0">
                                      <label for="backgroundColorBadgeCustom" class="col-md-6">Colore di Sfondo</label>
                                      <div class="col-md-6">
                                        <input name="backgroundColorBadgeCustom" type="color" v-model="gamedata.css_style.background.style.badge.customized['background-color']">
                                      </div>
                                    </div>
                                    <div class="form-group row pl-3 my-0 mb-1">
                                      <label for="borderWidthBadgeCustom" class="col-md-6 pt-1">Spessore del Bordo</label>
                                      <div class="col-md-6">
                                        <input name="borderWidthBadgeCustom" type="number" step="1" min="0" @change="badgeBorderSize"
                                               :value="gamedata.css_style.background.style.badge.customized['border-width'].slice(0,-2)">
                                      </div>
                                    </div>
                                    <div class="form-group row pl-3 my-0">
                                      <label for="borderColorBadgeCustom" class="col-md-6">Colore del Bordo</label>
                                      <div class="col-md-6">
                                        <input name="borderColorBadgeCustom" type="color" v-model="gamedata.css_style.background.style.badge.customized['border-color']">
                                      </div>
                                    </div>
                                    <div class="form-group row pl-3 my-0">
                                      <label class="col-md-6 pt-2">Tipo di Bordo</label>
                                      <div class="col-md-6">
                                        <select class="form-control" name="borderStyleBadgeCustom" v-model="gamedata.css_style.background.style.badge.customized['border-style']">
                                          <option v-for="styles in bootstrapConsts.badgeAlertBorderStyles" :value="styles.value">{{ styles.name }}</option>
                                        </select>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="container-fluid text-center mb-0 mt-2">
                                    <label for="badgeCheckbox">Personalizza</label>
                                    <input id="badgeCheckbox" type="checkbox" v-model="gamedata.css_style.background.style.badge.custom">
                                  </div>
                                </div>
                              </div>
                            </div>
                            <!-- ALERT -->
                            <div class="panel panel-default">
                              <div class="panel-heading py-2 border-bottom">
                                <div class="panel-title" data-toggle="collapse" data-parent="#setStyle" href="#alertStyleEditor" @click="styleMenuCollapse">
                                  <label>Etichetta aiuto richiesto</label>
                                </div>
                              </div>
                              <div id="alertStyleEditor" class="panel-collapse collapse stylepanelcollapse">
                                <div class="panel-body border-bottom mt-2">
                                  <!-- tipologia predefinita -->
                                  <div v-if="!gamedata.css_style.background.style.alert.custom">
                                    <div class="form-group row pl-4 my-0">
                                      <label class="col col-form-label">Tipologia</label>
                                      <div class="col">
                                        <select class="form-control" name="alertBootstrapEditor" v-model="gamedata.css_style.background.style.alert.bootstrap.type">
                                          <option v-for="styles in bootstrapConsts.alertColors" :value="styles.value">{{ styles.name }}</option>
                                        </select>
                                      </div>
                                    </div>
                                  </div>
                                  <!-- stile personalizzato -->
                                  <div v-if="gamedata.css_style.background.style.alert.custom">
                                    <div class="form-group row pl-3 my-0">
                                      <label for="textColorAlertCustom" class="col-md-6">Colore del Testo</label>
                                      <div class="col-md-6">
                                        <input name="textColorAlertCustom" type="color" v-model="gamedata.css_style.background.style.alert.customized['color']">
                                      </div>
                                    </div>
                                    <div class="form-group row pl-3 my-0">
                                      <label for="backgroundColorAlertCustom" class="col-md-6">Colore di Sfondo</label>
                                      <div class="col-md-6 row">
                                        <div class="col-4">
                                          <input :disabled="alertBackgroundTransparent" name="backgroundColorAlertCustom" type="color" v-model="gamedata.css_style.background.style.alert.customized['background-color']">
                                        </div>
                                        <div class="col-8">
                  												<label for="transparentAlert">trasparente</label>
                  												<input id="transparentAlert" type="checkbox" v-model="alertBackgroundTransparent" @change="alertBackground">
                  											</div>
                                      </div>
                                    </div>
                                    <div class="form-group row pl-3 my-0 mb-1">
                                      <label for="borderWidthAlertCustom" class="col-md-6 pt-1">Spessore del Bordo</label>
                                      <div class="col-md-6">
                                        <input name="borderWidthAlertCustom" type="number" step="1" min="0" value="0" @change="alertBorderSize"
                                               :value="gamedata.css_style.background.style.alert.customized['border-width'].slice(0,-2)">
                                      </div>
                                    </div>
                                    <div class="form-group row pl-3 my-0">
                                      <label for="borderColorAlertCustom" class="col-md-6">Colore del Bordo</label>
                                      <div class="col-md-6">
                                        <input name="borderColorAlertCustom" type="color" v-model="gamedata.css_style.background.style.alert.customized['border-color']">
                                      </div>
                                    </div>
                                    <div class="form-group row pl-3 my-0">
                                      <label class="col pt-2">Tipo di Bordo</label>
                                      <div class="col">
                                        <select class="form-control" name="borderStyleAlertCustom" v-model="gamedata.css_style.background.style.alert.customized['border-style']">
                                          <option v-for="styles in bootstrapConsts.badgeAlertBorderStyles" :value="styles.value">{{ styles.name }}</option>
                                        </select>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="container-fluid text-center mb-0 mt-2">
                                    <label for="alertCheckbox">Personalizza</label>
                                    <input id="alertCheckbox" type="checkbox" v-model="gamedata.css_style.background.style.alert.custom">
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                  			</div>
      							</div>
      							<!-- STILI GLOBALI DEL TESTO -->
      							<div id="mainStyles" class="col-md-6 pl-4">
      									<div class="form-group row">
      										<label for="fontFamilyField" class="col-md-4 col-form-label">Font</label>
      										<div class="col-md-8">
      										  <input name="fontFamilyField" type="text" readyonly v-model="gamedata.css_style.mainStyle['font-family']">
      										</div>
      									</div>
      									<div class="form-group row">
      										<label for="fontStyleField" class="col-md-4 col-form-label">Stile del Testo</label>
      										<div class="col-md-8">
      											<select name="fontStyleField" class="form-control col-md-8" v-model="gamedata.css_style.mainStyle['font-style']">
                      		  	<option value="normal">normale</option>
                      		  	<option value="italic">obliquo</option>
                     				</select>
      										</div>
      									</div>
      									<div class="form-group row">
      										<label for="fontWeightField" class="col-md-4 col-form-label">Peso del Testo</label>
      										<div class="col-md-8">
      											<select name="fontWeightField" class="form-control col-md-8" v-model="gamedata.css_style.mainStyle['font-weight']">
                      		  	<option value="normal">normale</option>
                      		  	<option value="bold">grassetto</option>
                     				</select>
      										</div>
      									</div>
      									<div class="form-group row">
      										<label for="fontSizeField" class="col-md-4 col-form-label">Dimensione del Testo</label>
      										<div class="col-md-8 ml-0 row">
      											<input class="form-control col-6" type="number" step="1" min="1" :disabled="textSizeNotSpecified" value="15" :value="gamedata.css_style.mainStyle['font-size'].slice(0,-2)" @change="fontSize">
                            <div class="col-6 pt-2 pl-3">
                              <label for="setTextSize">non specificare</label>
                              <input id="setTextSize" type="checkbox" v-model="textSizeNotSpecified" @change="textSizeSetting">
                            </div>
      										</div>
      									</div>
      									<div class="form-group row">
      										  <label class="col-4">Colore del Testo</label>
                            <div class="col-8 row">
        				              <div class="col-4">
        												<input type="color" v-model="currentMainStyleColor" @change="editMainColor">
        											</div>
        											<div class="col-8">
        												<label for="applyMainColor">Applica</label>
        												<input id="applyMainColor" type="checkbox" v-model="mainStyleColor" @change="editMainColor">
        											</div>
                              <small v-if="mainStyleColor && !gamedata.css_style.background.image" class="row form-text text-muted ml-6">
                                 Verranno sovrascritti tutti i colori del testo specificati in altre sezioni
                              </small>
                            </div>
      								  </div>
      							</div>
    		          </div>
                  <!-- caricamento e salvataggio stili -->
                  <div class="container-fluid row border-top">
                    <div id="saveload-style" class="col-md-8 row mt-3 ml-3">
                        <div class="col-md-6">
                            <label for="select-style">Stili Salvati</label>
                            <select name="select-style" ref="select_style">
                                <option v-for="style in styleList" :value="style">{{ style }}</option>
                            </select>
                            <div class="btn btn-group">
                                <button class="btn btn-success" v-on:click="getStyle">GET</button>
                                <button class="btn btn-danger" v-on:click="deleteStyle">DELETE</button>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <label for="name_style">Salva come:</label>
                            <input name="name_style" type="text" ref="style_name">
                            <div class="btn btn-group">
                                <button class="btn btn-primary" v-on:click="saveStyle">SAVE</button>
                            </div>
                        </div>
                    </div>
                  </div>
                </div>
                <!--PREVIEW-->
                <div id="preview-container" class="container-fluid py-3 row border-bottom">
                  <div id="preview" :class="previewMode" :style="previewStyle" class="p-0">
                      <nav class="navbar" :class="navbarBootstrapStyle" :style="navbarStyle">
                          <div class="navbar-brand" :style="navbarBrandStyle">Menu
                              <span class="badge" :class="badgeBootstrapStyle" :style="badgeStyle" v-if="getSubquests.length > 0" role="alert">Subs!</span>
                          </div>
                          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsiblemenu" :style="toggleButtonContainer" v-observe-visibility="buttonChangedVisibility" aria-label="Apri il menu">
                              <span class="navbar-toggler-icon" :style="{ 'background-image': togglerButtonStyle }"></span> <!-- v-observe-visibility="buttonChangedVisibility" -->
                          </button>
                          <div class="collapse navbar-collapse" id="collapsiblemenu">
                              <ul class="navbar-nav" aria-labelledby="quest-menu-button">
                                  <li class="nav-item dropdown">
                                      <a class="nav-link dropdown-toggle" id="quest-menu-button" data-toggle="dropdown" :style="questsStyle" role="button"
                                      aria-haspopup="true" role="menu" aria-controls="quest-menu-list">Quests</a>
                                      <div class="dropdown-menu" id="quest-menu-list" :class="menuBootstrapStyle" :style="menuStyle" style="margin-bottom: 10px">
                                          <a class="dropdown-item" :style="menuLinkStyle(0,true)" v-on:mouseover="menuLinkEvent(0,true)" v-on:mouseleave="menuLinkEvent(0,false)" role="menuitem"
                                           v-on:click="jumpToQuest('main',previewdata.currentQuest)">MainQuest {{ previewdata.currentQuest }}</a>
                                          <div v-if="getSubquests.length > 0" role="none">
                                              <div class="dropdown-divider" :style="dividerStyle"></div>
                                              <a class="dropdown-item" role="menuitem" :style="menuLinkStyle(index+1,true)" v-on:mouseover="menuLinkEvent(index+1,true)"
                                              v-on:mouseleave="menuLinkEvent(index+1,false)" v-for="(quest,index) in getSubquests" v-on:click="jumpToQuest('sub',quest.number)">
                                                  Subquest {{quest.number}}: {{quest.title}}
                                              </a>
                                          </div>
                                      </div>
                                  </li>
                                  <li class="nav-item" v-if="currentComponent">
                                      <a id="helpAlertContainer" class="nav-link" ref="help" @click="requestHelp" :style="helpAlertContainerStyle">
                                          Chiedi aiuto
                                          <span ref="requestedHelp" class="alert" role="alert" :class="helpAlertBootstrapStyle" :style="helpAlertStyle"
                                          style="display:none; margin-left: 10px; margin-bottom: -10px;  white-space: nowrap;">Aiuto richiesto! Attendi...</span>
                                      </a>
                                  </li>
                                  <li class="nav-item">
                                      <a class="nav-link" style="width: max-content" :style="menuLinkStyle(0,false)">LOGOUT</a>
                                  </li>
                              </ul>
                          </div>
                      </nav>
                      <!--Area quest-->
                      <div ref="questrender" class="card player-card-author overflow-auto" :class="cardBootstrapStyle" :style="cardStyle" aria-live="polite">
                          <div class="card-header" :style="cardLimitStyle">
                              <h3 id="questname" ref="questname" tabindex="-1" :style="removePredefinedStylesCard">
                                  {{previewdata.in_mainquest ? "Quest" : "Subquest"}}
                                  {{ previewdata.in_mainquest ? previewdata.currentQuest : previewdata.currentSub }}: {{ renderQuest.title || "no_name" }}
                              </h3>
                          </div>
                          <div class="card-body overflow-auto" :style="removePredefinedStylesCard">
                              <form ref="inputForm" v-on:submit.prevent="previewdata.in_mainquest? submitMain() : submitSub()">
                                      <p style="white-space: pre-line;">{{ renderQuest.text }}</p>
                                      <p style="white-space: pre-line;">{{ renderQuest.description || "" }}</p>
                                      <ul v-if="previewdata.in_mainquest && getCurrentClues.length > 0">
                                              <li v-for="clue in getCurrentClues" v-if="clue">{{ clue }}</li>
                                      </ul>
                                      <!--Qua sotto div in cui caricare box per dare input usando components, cambia a seconda del tipo di quest-->
                                      <div id="gameinput">
                                        <component v-bind:is="currentComponent" :gamedata="renderQuest" :metadata="metadata" :current="previewdata.in_mainquest ? previewdata.currentQuest : previewdata.currentSub"
                                        :options="previewdata.in_mainquest ? getCurrentOptions : renderQuest.options" v-model="previewdata.picked" @change="upgradeSubmitStyle(false)" ref="inputComponent" :styles="componentStyle"></component>
                                      </div>
                              </form>
                              <!--EVENTUALI MEDIA-->
                              <div v-if="renderQuest.media">
                                  <img width="100%" v-if="renderQuest.media.type=='image'" :src="getMediaSrc" :alt="renderQuest.media.alt">
                                  <div v-if="renderQuest.media.type=='video'">
                                      <video width="100%" :aria-label="renderQuest.media.alt" controls :src="getMediaSrc">
                                      </video>
                                  </div>
                              </div>
                          </div>
                          <div v-if="renderQuest.type != 'ending'" class="card-footer" :style="cardLimitStyle">
                              <button id="submit" ref="submitbutton" class="btn-default" :class="submitBootstrapStyle" :disabled="submitDisabled" :style="submitStyle" v-on:click="previewdata.in_mainquest? submitMain() : submitSub()">
                                  Submit
                              </button>
                          </div>
                      </div>
                  </div>
                  <div id="preview-options" class="col-md-4">
                    <div id="current-answer" v-if="previewdata.picked" class="overflow-auto m-3" style="word-wrap:break-word;">
                        <p>Risposta corrente: {{ previewdata.picked }}</p>
                        <div v-if="previewdata.in_mainquest">
                            <button class="btn btn-secondary" v-if="getCurrentGotos.length > 0" data-toggle="tooltip"
                            :title="gamedata.mainQuest[getAnswerGoto].title" v-on:click="jumpToQuest('main',getAnswerGoto)">
                                {{ "Questa risposta porterà a " + (gamedata.mainQuest[getAnswerGoto].title || getAnswerGoto)}}
                            </button>
                        </div>
                        <div v-if="!previewdata.in_mainquest">
                            <p>La risposta è {{ getAnswerCorrectness ? "giusta" : "sbagliata" }}!</p>
                        </div>
                    </div>
                    <div class="m-3">
						          <div class="btn-group">
                       <button class="col btn btn-warning" v-on:click="switchView(false)">PC</button>
                       <button class="col btn btn-danger" v-on:click="switchView(true)">MOBILE</button>
                     </div>
                    </div>
                  </div>
                </div>
                <!--FINE PREVIEW-->
                <!--OBJECT EDITOR-->
                <div id="questgraph" class="container-fluid pt-3 row">
                    <!--PREV-->
                    <div class="col-md-2 border-right pt-2 pb-2">
                        <h2 class="bg-info text-light">Nodi Precedenti</h2>
                        <button class="btn btn-secondary btn-block" v-for="prev in previewdata.in_mainquest ? getPrevNodes : renderQuest.requires_sub"
                        data-toggle="tooltip" :title="previewdata.in_mainquest ? gamedata.mainQuest[prev].title : gamedata.subQuests[prev].title"
                        v-on:click="previewdata.in_mainquest ? jumpToQuest('main',prev) : jumpToQuest('sub',prev)">
                            {{ previewdata.in_mainquest ? ( gamedata.mainQuest[prev].title || prev ) : ( gamedata.subQuests[prev].title || prev ) }}
                        </button>
                    </div>
                    <!--CAMPI QUEST ATTUALE-->
                    <div class="col-md-6 border-right pt-2 pb-2">
                        <!--Quest ID-->
                        <div class="form-group row mb-2">
                            <label for="numberfield" class="col-md-2 col-form-label">Numero</label>
                            <div class="col-md-10">
                                <input name="numberfield" type="text" readyonly class="form-control-plaintext" :value="renderQuest.number">
                            </div>
                        </div>
                        <!--Quest TITLE-->
                        <div class="form-group row mb-2">
                            <label for="titlefield" class="col-md-2 col-form-label">Titolo</label>
                            <div class="col-md-10">
                                <input name="titlefield" type="text" class="form-control" v-model="renderQuest.title">
                            </div>
                        </div>
                        <!--Quest TEXT-->
                        <div class="form-group row mb-2">
                            <label for="textfield" class="col-md-2 col-form-label">Testo</label>
                            <div class="col-md-10">
                                <textarea name="textfield" class="form-control" type="text" v-model="renderQuest.text"></textarea>
                            </div>
                        </div>
                        <!--Quest STARTING POINT (main quest only)-->
                        <div v-if="previewdata.in_mainquest" class="form-check container mb-2">
                            <label for="startfield" class="form-check-label">
                                <input type="checkbox" class="form-check-input" :value="renderQuest.number" v-model="gamedata.starting_points">
                                Quest Iniziale
                            </label>
                        </div>
                        <!--Quest AVAILABLE_ON (subquests only)-->
                        <label for="availableonfield" v-if="!previewdata.in_mainquest">Disponibile nelle Quest</label>
                        <div name="availableonfield" v-if="!previewdata.in_mainquest">
                            <div v-for="quest in gamedata.mainQuest" class="form-check form-check-inline" data-toggle="tooltip" :title="quest.title">
                                <input type="checkbox" class="form-check-input" :name="'quest' + quest.number" :value="quest.number" v-model="renderQuest.available_on">
                                <label for="'quest' + quest.number" class="form-check-label"> {{ quest.number }}</label>
                            </div>
                        </div>
                        <!--Quest REQUIRES_SUBQUEST (subquests only)-->
                        <label for="subreqfield" v-if="!previewdata.in_mainquest">Richiede le Subquest</label>
                        <div name="subreqfield" v-if="!previewdata.in_mainquest">
                            <div v-for="sub in gamedata.subQuests" class="form-check form-check-inline" data-toggle="tooltip" :title="sub.title">
                                <input type="checkbox" class="form-check-input" :name="'sub' + sub.number" :value="sub.number" v-model="renderQuest.requires_sub">
                                <label :for="'quest' + sub.number">{{ sub.number }}</label>
                            </div>
                        </div>
                        <!--Quest DESCRIPTION-->
                        <div class="form-group row mb-2">
                            <label for="descriptionfield" class="col-md-2 col-form-label">Descrizione</label>
                            <div class="col-md-10">
                                <textarea name="descriptionfield" class="form-control" type="text" v-model="renderQuest.description"></textarea>
                            </div>
                        </div>
                        <!--Quest SCORE (subquest only)-->
                        <div v-if="!previewdata.in_mainquest">
                            <div class="form-group row mb-2">
                                <label for="scorefield" class="col-md-2 col-form-label">Punteggio</label>
                                <div class="col-md-4">
                                    <input type="number" v-model="renderQuest.sub_score">
                                </div>
                            </div>
                        </div>
                        <!--Quest INPUT TYPE-->
                        <label name="inputtypefield">Tipo di Input</label>
                        <div name="inputtypefield">
                            <div class="form-check form-check-inline">
                                <input type="radio" id="nonechoice" class="form-check-input" name="typefield" value="" v-model="renderQuest.type">
                                <label for="nonechoice" class="form-check-label">Nessuno</label>
                            </div>
                            <div class="form-check form-check-inline" v-if="previewdata.in_mainquest">
                                <input type="radio" id="choicechoice" class="form-check-input" name="typefield" value="choice" v-model="renderQuest.type">
                                <label for="choicechoice" class="form-check-label">Scelta</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input type="radio" id="texthoice" class="form-check-input" name="typefield" value="input" v-model="renderQuest.type">
                                <label for="textchoice" class="form-check-label">Testo</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input type="radio" id="imgchoice" class="form-check-input" name="typefield" value="draw" v-model="renderQuest.type">
                                <label for="imgchoice" class="form-check-label">Immagine</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input type="radio" id="keyschoice" class="form-check-input" name="typefield" value="keys" v-model="renderQuest.type">
                                <label for="keyschoice" class="form-check-label">Tastiera</label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input type="radio" id="humanchoice" class="form-check-input" name="typefield" value="human" v-model="renderQuest.type">
                                <label for="humanchoice" class="form-check-label">Umano</label>
                            </div>
                            <div class="form-check form-check-inline" v-if="previewdata.in_mainquest">
                                <input type="radio" id="endchoice" class="form-check-input" name="typefield" value="ending" v-model="renderQuest.type">
                                <label for="endchoice" class="form-check-label">Finale</label>
                            </div>
                        </div>
                        <!--Quest INSERT MEDIA-->
                        <label name="mediafield" class="mt-2">Inserisci Media</label>
                        <div v-if="renderQuest.media" name="mediafield">
                            <div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" id="media-type-image" name="choose-media" value="" v-model="renderQuest.media.type">
                                    <label class="form-check-input" for="media-type-image">Nessuno</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" id="media-type-image" name="choose-media" value="image" v-model="renderQuest.media.type">
                                    <label class="form-check-input" for="media-type-image">Immagine</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" id="media-type-video" name="choose-media" value="video" v-model="renderQuest.media.type">
                                    <label class="form-check-input" for="media-type-video">Video</label>
                                </div>
                            </div>
                            <div v-if="renderQuest.media.type">
                                <label for="select-media">Seleziona il media da utilizzare</label>
                                <select v-model="renderQuest.media.uri">
                                    <option v-for="opt in (renderQuest.media.type=='image' ? imagesList : vidsList)" :value="opt">{{ opt }}</option>
                                </select>
                                <div class="form-group container row">
                                    <label for="media-alt" class="mr-2">Descrizione:</label>
                                    <textarea name="media-alt" v-model="renderQuest.media.alt"></textarea>
                                </div>
                            </div>
                        </div>
                        <!-- Quest OPTIONS (only if type is choice)-->
                        <label for="optionsfield" v-if="renderQuest.type == 'choice'">Opzioni</label>
                        <div name="optionsfield" v-if="renderQuest.type == 'choice'">
                            <div class="form-group" v-for="opt in renderQuest.options">
                                <input class="form-control" v-model="renderQuest.options[renderQuest.options.indexOf(opt)]">
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-outline-primary" v-on:click="addRmOptions('add')">Aggiungi</button>
                                <button class="btn btn-outline-primary" v-on:click="addRmOptions('rm')">Rimuovi</button>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-outline-primary" v-on:click="generateChoiceGotos">Genera Destinazioni</button>
                            </div>
                        </div>
                        <!-- Quest CHOOSE IMAGE (only if type is draw)-->
                        <div v-if="renderQuest.type == 'draw'">
                            <div class="form-group">
                                <label for="select-image">Scegli l'immagine</label>
                                <select name="select-image" class="form-control" v-model="renderQuest.image.imguri">
                                    <option v-for="imgname in imagesList" :value="imgname">{{ imgname }}</option>
                                </select>
                            </div>
                            <div id="image-preview" v-if="renderQuest.image.imguri" class="container p-1">
                                <img class="img-thumbnail" :src="'story/' + metadata.name + '/images/' + renderQuest.image.imguri" :alt="'Preview of ' + renderQuest.image.imguri">
                            </div>
                            <div class="form-group">
                                <label for="setImgAlt">Scegli un alt per l'immagine</label>
                                <input name="setImgAlt" class="form-control" type="text" v-model="renderQuest.image.imgalt">
                            </div>
                            <button class="btn btn-outline-secondary" v-on:click="setImageAsInput">Set</button>
                        </div>
                        <!-- Quest CUSTOMIZE KEYBOARD (only if type is keys)-->
                        <div v-if="renderQuest.type == 'keys'" class="border-top border-bottom p-2 m-2">
                            <div class="row">
                                <div class="col-9 text-center m-1">
                                    <button class="btn btn-outline-info" data-target="#key-customization" data-toggle="collapse">Personalizza la Tastiera</button>
                                </div>
                                <div id="key-customization" class="collapse row p-2">
                                    <div name="button-customize" class="col-lg-6 border-right m-1">
                                        <label for="keybutton-customize" class="font-weight-bold text-info mb-2">Personalizza Bottoni</label>
                                        <div class="form-group mb-3">
                                            <label class="mr-2" for="keys">Tasti</label>
                                            <textarea class="form-control mr-2" v-model="renderQuest.key_style.keys"></textarea>
                                        </div>
                                        <div class="form-group row mb-3">
                                            <div class="col-lg-4">
                                                <label for="btn-width">Larghezza</label>
                                                <input class="form-control" type="number" step="0.1" min="0" v-model="renderQuest.key_style.width">
                                            </div>
                                            <div class="col-lg-4">
                                                <label for="btn-width">Altezza</label>
                                                <input class="form-control" type="number" step="0.1" min="0" v-model="renderQuest.key_style.height">
                                            </div>
                                        </div>
                                        <div class="form-group row mb-3">
                                            <div class="col-lg-4">
                                                <label for="textfont">Font</label>
                                                <input name="textfont" class="form-control" type="text" v-model="renderQuest.key_style.text_font">
                                            </div>
                                            <div class="col-lg-4">
                                                <label for="textcolor">Colore</label>
                                                <input name="textcolor" type="color" v-model="renderQuest.key_style.text_color">
                                            </div>
                                        </div>
                                        <div class="form-group row mb-3">
                                            <div class="col-lg-4">
                                                <label for="textsize">Dimensione</label>
                                                <input name="textsize" class="form-control" type="number" step="1" min="0" v-model="renderQuest.key_style.text_size">
                                            </div>
                                            <div class="form-check">
                                                <label for="bold" class="form-check-label">
                                                    <input name="bold" class="form-check-input" type="checkbox" v-model="renderQuest.key_style.bold">
                                                    Grassetto
                                                </label>
                                            </div>
                                        </div>
                                        <div class="form-group row mb-3">
                                            <label for="bgcolor" class="col-md-3">Colore Sfondo</label>
                                            <input name="bgcolor" type="color" v-model="renderQuest.key_style.bg_color">
                                        </div>
                                        <div class="form-group row mb-3">
                                            <div class="col-lg-4">
                                                <label for="bordercolor">Colore Bordo</label>
                                                <input name="bordercolor" type="color" v-model="renderQuest.key_style.border_color">
                                            </div>
                                            <div class="col-lg-4">
                                                <label for="bordersize" >Spessore Bordo</label>
                                                <input name="bordersize" class="form-control" type="number" step="1" min="0" v-model="renderQuest.key_style.border_size">
                                            </div>
                                        </div>
                                        <div class="form-group row mb-3">
                                            <div class="col-lg-4">
                                                <label for="borderrad" >Raggio Bordo</label>
                                                <input name="borderrad" class="form-control" type="number" step="1" min="0" v-model="renderQuest.key_style.radius">
                                            </div>
                                            <div class="col-lg-4">
                                                <label for="margin">Margine</label>
                                                <input name="margin" class="form-control" type="number" step="0.1" min="0" v-model="renderQuest.key_style.margin">
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="form-check col-lg-4">
                                            <label for="shadow" class="form-check-label">
                                                <input name="shadow" class="form-check-input" type="checkbox" v-model="renderQuest.key_style.shadow">
                                                Ombreggiatura
                                            </label>
                                            </div>
                                        </div>
                                        <div class="form-group row">
                                            <div class="col-lg-6">
                                                <label for="animation">Animazione</label>
                                                <select name="animation" class="form-control" v-model="renderQuest.key_style.animation">
                                                    <option value="">None</option>
                                                    <option value="press">Pressione</option>
                                                    <option value="flash">Flash</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="keyscreen-customize" class="col-lg-4 m-1">
                                        <label class="mb-2 font-weight-bold text-info">Personalizza prompt</label>
                                        <div class="form-group row mb-3">
                                            <label for="screenfont">Font</label>
                                            <input name="screenfont" class="form-control" type="text" v-model="renderQuest.key_style.screen_font">
                                        </div>
                                        <div class="form-group row mb-3">
                                            <div class="col-lg-4"><label for="screencolor">Colore Font</label></div>
                                            <div class="col-lg-2"><input name="screencolor" type="color" v-model="renderQuest.key_style.screen_color"></div>
                                        </div>
                                        <div class="form-group form-check mb-3">
                                            <label for="screenbold" class="form-check-label">
                                            <input name="screenbold" class="form-check-input" type="checkbox" v-model="renderQuest.key_style.screen_bold">
                                            Grassetto
                                            </label>
                                        </div>
                                        <div class="form-group row mb-3">
                                            <div class="col-lg-4"><label for="screenbg">Colore Sfondo</label></div>
                                            <div class="col-lg-2"><input name="screenbg" type="color" v-model="renderQuest.key_style.screen_bg"></div>
                                        </div>
                                        <div class="form-group row mb-3">
                                            <div class="col-lg-4"><label for="screenbordercolor">Colore Bordo</label></div>
                                            <div class="col-lg-2"><input name="screenbordercolor" type="color" v-model="renderQuest.key_style.screen_border_color"></div>
                                        </div>
                                        <div class="form-group row mb-3">
                                            <div class="col-lg-4"><label for="screenborder">Spessore Bordo</label></div>
                                            <div class="col-lg-3"><input type="number" step="1" min="0" v-model="renderQuest.key_style.screen_border_size"></div>
                                        </div>
                                        <div class="form-group row mb-3">
                                            <div class="col-lg-4"><label for="screenlength">Lunghezza</label></div>
                                            <div class="col-lg-3"><input name="screenlength" type="number" step="0.1" min="0" v-model="renderQuest.key_style.screen_length"></div>
                                        </div>
                                        <div class="mt-3 border-top">
                                            <label for="description" class="font-weight-bold text-info">Descrizione per accessibilità</label>
                                            <div name="description" class="form-group mb-3">
                                                <textarea class="form-control" v-model="renderQuest.key_style.description"></textarea>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="saveload-keystyle" class="row">
                                <div class="col-md-6">
                                    <label for="select-keystyle">Stili Salvati</label>
                                    <select name="select-keystyle" ref="select_key_style">
                                        <option v-for="style in keyStylesList" :value="style">{{ style }}</option>
                                    </select>
                                    <div class="btn btn-group">
                                        <button class="btn btn-success" v-on:click="getKeyStyle">GET</button>
                                        <button class="btn btn-danger" v-on:click="deleteKeyStyle">DELETE</button>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <label for="name_keystyle">Salva come:</label>
                                    <input name="name_keystyle" type="text" ref="key_style_name">
                                    <div class="btn btn-group">
                                        <button class="btn btn-primary" v-on:click="saveKeyStyle">SAVE</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Quest SUBQUEST REWARDS (main quests only)-->
                        <label for="subrewardfield" v-if="previewdata.in_mainquest">Ricompense per le Subquest</label>
                        <div name="subrewardfield" v-if="previewdata.in_mainquest">
                            <div class="btn-group">
                                <button class="btn btn-outline-primary" v-on:click="addSubReward">Aggiungi</button>
                                <select name="subquests" class="form-control" ref="subtoadd">
                                    <option v-for="sub in getRemainingSubs" :value="sub.number">{{ (sub.title || sub.number) }}</option>
                                </select>
                            </div>
                            <div v-for="sub in renderQuest.subquest_rewards" class="container-fluid pt-1">
                                <div class="btn-group">
                                    <button class="btn btn-outline-secondary" :data-target="'#' + 'reward' + sub.number" data-toggle="collapse">
                                        Ricompensa per {{ (sub.title || sub.number) }}
                                    </button>
                                    <button class="btn btn-outline-danger" v-on:click="rmSubReward(sub)">Rimuovi Ricompensa</button>
                                </div>
                                <div :id="'reward' + sub.number" class="collapse container p-2 border-bottom">
                                    <!--Reward NUMBER-->
                                    <div class="form-group row">
                                        <label class="col-md-2 col-form-label" for="subnumber">Numero</label>
                                        <div class="col-md-10">
                                            <input type="text" name="subnumber" readonly class="form-control-plaintext" :value="sub.number">
                                        </div>
                                    </div>
                                    <!--Reward CLUE-->
                                    <div class="form-group row">
                                        <label class="col-md-2 col-form-label" for="cluefield">Indizio</label>
                                        <div class="col-md-10">
                                            <input name="cluefield" type="text" v-model="sub.clue">
                                        </div>
                                    </div>
                                    <!--Reward ADDED OPTIONS-->
                                    <label for="subchoice" v-if="renderQuest.type=='choice'">Opzioni Aggiuntive</label>
                                    <div name="subchoice" v-if="renderQuest.type=='choice'">
                                        <div v-for="opt in sub.added_options">
                                            <input v-model="sub.added_options[sub.added_options.indexOf(opt)]">
                                        </div>
                                        <div class="btn-group">
                                            <button class="btn btn-outline-primary" v-on:click="addRmSubAddedOptions('add',renderQuest.subquest_rewards.indexOf(sub))">Add</button>
                                            <button class="btn btn-outline-primary" v-on:click="addRmSubAddedOptions('rm',renderQuest.subquest_rewards.indexOf(sub))">Remove</button>
                                        </div>
                                    </div>
                                    <!--Reward REMOVED OPTIONS-->
                                    <label for="rmoptsub" v-if="renderQuest.type=='choice'" class="mt-3">Opzioni Rimosse</label>
                                    <div name="rmoptsub" v-if="renderQuest.type=='choice'">
                                        <div v-for="opt in renderQuest.options">
                                            <input readonly class="form-control" :value="opt">
                                            <div class="form-check row">
                                                <input type="checkbox" :name="'opt' + renderQuest.options.indexOf(opt)" class="form-check-input" :value="opt" v-model="sub.removed_options">
                                                <label :for="'opt' + renderQuest.options.indexOf(opt)" class="form-check-label">Rimuovi</label>
                                            </div>
                                        </div>
                                    </div>
                                    <!--Reward ADDED GOTOS-->
                                    <label for="addedgotosub" class="mt-3">Destinazioni Aggiuntive</label>
                                    <div name="addedgotosub">
                                        <div class="form-group row" v-for="goto in sub.added_goto">
                                            <input class="form-control col-md-6" type="text" v-model="goto[0]" placeholder="Risposta">
                                            <select class="form-control col-md-3" name="quests" v-model="goto[1]">
                                                <option v-for="quest in questList" :value="quest.number">{{ (quest.title || quest.number) }}</option>
                                            </select>
                                            <input v-if="goto[2] !== undefined" class="form-control col-md-6" v-model="goto[2]" placeholder="Punteggio">
                                            <div class="btn-group">
                                                <button class="btn btn-outline-danger" v-on:click="rmAddedGoto(sub,goto)">Rimuovi</button>
                                            </div>
                                        </div>
                                        <div class="btn-group">
                                            <button class="btn btn-outline-primary" v-on:click="addAddedGoto(sub)">Aggiungi</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!--GOTOS-->
                    <div class="col-md-4 pt-2 pb-2">
                        <!--GOTOS in caso di mainquest-->
                        <div id="goto-management" v-if="previewdata.in_mainquest">
                            <div v-if="previewdata.in_mainquest">
                                <p>Se nessuna risposta è corretta verrà scelta automaticamente l'ultima</p>
                                <div class="container-fluid border-bottom pb-4">
                                    <h2 class="bg-info text-light">Destinazioni di Default</h2>
                                    <div class="form-group" v-for="opt in renderQuest.goto">
                                        <input class="form-control" type="text" v-model="opt[0]" placeholder="Risposta">
                                        <select class="form-control" name="quests" v-model="opt[1]">
                                            <option v-for="quest in questList" data-toggle="tooltip" :title="quest.title" :value="quest.number">{{ ( quest.title || quest.number ) }}</option>
                                        </select>
                                        <input v-if="opt[2] !== undefined" class="form-control" type="text" v-model="opt[2]" placeholder="Punteggio attribuito">
                                        <!--Removed gotos for subquest_rewards-->
                                        <label for="goto-remove" class="form-check-label">Rimosso da:</label>
                                        <div name="goto-remove">
                                            <div class="form-check form-check-inline" v-for="reward in renderQuest.subquest_rewards">
                                                <input class="form-check-input" type="checkbox" :name="'sub' + renderQuest.subquest_rewards.indexOf(reward)" :value="opt" v-model="reward.removed_goto">
                                                <label class="form-check-label" :for="'sub' + renderQuest.subquest_rewards.indexOf(reward)">Ricompensa {{ reward.number }}<label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="btn-group">
                                        <button class="btn btn-primary" v-on:click="addGoto('')">Aggiungi Vuoto</button>
                                        <button class="btn btn-danger" v-on:click="rmGoto">Rimuovi</button>
                                    </div>
                                    <div v-if="renderQuest.type=='draw'" class="container-fluid pt-2">
                                        <p>O clicka su un punto della preview e imposta un raggio per generare la risposta corretta dell'immagine.</p>
                                        <div class="btn-group">
                                            <div class="form-group">
                                                <label for="goto-radius">Raggio</label>
                                                <input class="form-control" type="text" v-model="radiusInput">
                                            </div>
                                            <p v-if="previewdata.picked">Risposta corretta impostata a {{ previewdata.picked }} con raggio {{ radiusInput }}.</p>
                                            <button class="btn btn-primary" v-on:click="addGoto('image')">Aggiungi</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="container-fluid">
                                    <h2 class="bg-info text-light mt-2">Destinazioni Aggiuntive</h2>
                                    <!--getAddedGotos restituisce coppia [indice subquest, goto]-->
                                    <div v-for="opt in getAddedGotos">
                                        <input type="text" v-model="renderQuest.subquest_rewards[opt[0]].added_goto[renderQuest.subquest_rewards[opt[0]].added_goto.indexOf(opt[1])][0]">
                                        <select name="quests" v-model="renderQuest.subquest_rewards[opt[0]].added_goto[renderQuest.subquest_rewards[opt[0]].added_goto.indexOf(opt[1])][1]">
                                            <option v-for="quest in questList" data-toggle="tooltip" :title="quest.title" :value="quest.number">{{ (quest.title || quest.number) }}</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="solutions-management" v-if="!previewdata.in_mainquest">
                            <h2 class="bg-info text-light">Soluzioni</h2>
                            <div class="mb-2" v-for="sol in renderQuest.solution">
                                <input class="form-control" type="text" v-model="renderQuest.solution[renderQuest.solution.indexOf(sol)]">
                                <button class="btn btn-danger" v-on:click="rmSolution(sol)">Rimuovi</button>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-primary" v-on:click="addSolution">Aggiungi</button>
                            </div>
                            <div v-if="renderQuest.type=='draw'" class="container-fluid pt-2">
                                <p>O clicka su un punto della preview e imposta un raggio per generare la risposta corretta dell'immagine.</p>
                                <div class="btn-group">
                                    <div class="form-group">
                                        <label for="goto-radius">Raggio</label>
                                        <input class="form-control" type="text" v-model="radiusInput">
                                    </div>
                                    <p v-if="previewdata.picked">Risposta corretta impostata a {{ previewdata.picked }} con raggio {{ radiusInput }}.</p>
                                    <button class="btn btn-primary" v-on:click="addSolution('draw')">Aggiungi</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <a hidden ref="qrcode" id="qrcode" href="placeholder" download></a>
                <!--FINE OBJECT EDITOR-->
            </div>
        </div>
    </div>

    </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
    <script type="text/javascript" src="style_consts.js"></script>
    <script type="text/javascript" src="utils.js"></script>
    <script type="text/javascript" src="vue_autore.js"></script>
</body>

</html>
